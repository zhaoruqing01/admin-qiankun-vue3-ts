# ä¸»åº”ç”¨ (Main App) - Qiankun å¾®å‰ç«¯æ¶æ„

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Qiankun å¾®å‰ç«¯æ¡†æ¶**çš„ Vue 3 + TypeScript + Vite ä¸»åº”ç”¨ã€‚ä¸»åº”ç”¨è´Ÿè´£æ•´ä¸ªå¾®å‰ç«¯ç³»ç»Ÿçš„åº”ç”¨æ³¨å†Œã€è·¯ç”±ç®¡ç†å’Œå…¨å±€çŠ¶æ€ç®¡ç†ã€‚

## é¡¹ç›®ç‰¹æ€§

- ğŸš€ **Vue 3 + TypeScript + Vite** - æœ€æ–°çš„å‰ç«¯å¼€å‘æŠ€æœ¯æ ˆ
- ğŸ¯ **Qiankun å¾®å‰ç«¯æ¡†æ¶** - å®ç°åº”ç”¨éš”ç¦»å’ŒåŠ¨æ€åŠ è½½
- ğŸ”„ **å…¨å±€çŠ¶æ€ç®¡ç†** - åŸºäº Qiankun çš„ `initGlobalState` å®ç°ä¸»å­åº”ç”¨é€šä¿¡
- ğŸ¨ **å®éªŒæ€§æ ·å¼éš”ç¦»** - é¿å…åº”ç”¨ä¹‹é—´çš„æ ·å¼æ±¡æŸ“
- ğŸ“± **è·¯ç”±ç®¡ç†** - åŸºäº Vue Router 4 çš„å•é¡µåº”ç”¨è·¯ç”±

## é¡¹ç›®ç»“æ„

```
main-vue3-ts/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # ç»„ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ Home.vue         # ä¸»é¡µç»„ä»¶
â”‚   â”‚   â””â”€â”€ micro-apps-container.vue  # å¾®åº”ç”¨å®¹å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ router/              # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts         # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ App.vue              # åº”ç”¨æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ main.ts              # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ style.css            # å…¨å±€æ ·å¼
â”œâ”€â”€ vite.config.ts           # Vite é…ç½®æ–‡ä»¶
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â””â”€â”€ package.json             # ä¾èµ–é…ç½®
```

## å®‰è£…ä¾èµ–

```bash
pnpm install
```

## å¼€å‘è¿è¡Œ

```bash
pnpm run dev
```

åº”ç”¨å°†åœ¨ `http://localhost:8080` å¯åŠ¨ã€‚

## ç”Ÿäº§æ„å»º

```bash
pnpm run build
```

## é¢„è§ˆæ„å»ºç»“æœ

```bash
pnpm run preview
```

## å…³é”®é…ç½®

### 1. å¾®åº”ç”¨æ³¨å†Œ

åœ¨ `src/main.ts` ä¸­æ³¨å†Œå¾®åº”ç”¨ï¼š

```typescript
registerMicroApps([
  {
    name: 'son01-vue3-ts', // å¾®åº”ç”¨åç§°ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
    entry: '//localhost:8081/', // å¾®åº”ç”¨å…¥å£åœ°å€
    container: '#micro-app-container', // å¾®åº”ç”¨å®¹å™¨ DOM é€‰æ‹©å™¨
    activeRule: '/son01-vue3-ts', // è·¯ç”±è§„åˆ™ï¼ˆå½“URLåŒ¹é…æ—¶åŠ è½½è¯¥åº”ç”¨ï¼‰
    props: {
      theme: 'light',
      onGlobalStateChange: actions.onGlobalStateChange, // å…¨å±€çŠ¶æ€å˜æ›´å›è°ƒ
      setGlobalState: actions.setGlobalState, // è®¾ç½®å…¨å±€çŠ¶æ€æ–¹æ³•
    },
  },
  // ... å…¶ä»–å¾®åº”ç”¨
]);
```

### 2. å…¨å±€çŠ¶æ€ç®¡ç†

ä½¿ç”¨ Qiankun çš„ `initGlobalState` å®ç°å…¨å±€çŠ¶æ€ç®¡ç†ï¼š

```typescript
const actions = initGlobalState({ name: 'å¼ ä¸‰', age: 18 });
```

å¾®åº”ç”¨å¯ä»¥é€šè¿‡ `props` æ¥æ”¶çŠ¶æ€å’Œæ›´æ–°æ–¹æ³•ã€‚

### 3. æ ·å¼éš”ç¦»

åœ¨ `start()` é…ç½®ä¸­å¯ç”¨å®éªŒæ€§æ ·å¼éš”ç¦»ï¼š

```typescript
start({
  sandbox: {
    experimentalStyleIsolation: true, // é˜²æ­¢å¾®åº”ç”¨æ ·å¼æ±¡æŸ“
  },
});
```

## å¼€å‘å»ºè®®

1. **æ¸¯å£ç®¡ç†** - ç¡®ä¿ä¸»åº”ç”¨ç«¯å£ (8080) å’Œå„å¾®åº”ç”¨ç«¯å£ (8081, 8082...) ä¸å†²çª
2. **è·¨åŸŸé…ç½®** - ä¸»åº”ç”¨å·²é…ç½® CORSï¼Œå…è®¸å­åº”ç”¨è·¨åŸŸè¯·æ±‚
3. **å®¹å™¨è®¾ç½®** - å¾®åº”ç”¨å®¹å™¨éœ€è®¾ç½® `width: 100%` å’Œ `height: 100%` ä»¥å æ»¡çˆ¶å®¹å™¨
4. **ä¾èµ–å…±äº«** - é¿å…åœ¨ä¸»åº”ç”¨å’Œå¾®åº”ç”¨ä¸­é‡å¤æ‰“åŒ…å…¬å…±ä¾èµ–ï¼ˆå¦‚ Vueã€Vue Routerï¼‰

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Vue 3 (Composition API)
- **å¾®å‰ç«¯**: Qiankun 2.10.16
- **è·¯ç”±**: Vue Router 4.6.3
- **æ„å»ºå·¥å…·**: Vite 7.2.2
- **è¯­è¨€**: TypeScript 5.9.3
- **æ ·å¼**: Sass 1.94.0

## ç›¸å…³æ–‡æ¡£

- [Qiankun å®˜æ–¹æ–‡æ¡£](https://qiankun.umijs.org/)
- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Vite å®˜æ–¹æ–‡æ¡£](https://vitejs.dev/)
- [Vue Router å®˜æ–¹æ–‡æ¡£](https://router.vuejs.org/)
